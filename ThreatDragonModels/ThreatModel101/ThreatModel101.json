{
  "version": "2.5.0",
  "summary": {
    "title": "ThreatModel101",
    "owner": "",
    "description": "",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 3,
        "title": "New generic diagram",
        "diagramType": "Generic",
        "placeholder": "New generic diagram description",
        "thumbnail": "./public/content/images/thumbnail.jpg",
        "version": "2.5.0",
        "cells": [
          {
            "position": {
              "x": -15,
              "y": 60
            },
            "size": {
              "width": 90,
              "height": 50
            },
            "attrs": {
              "text": {
                "text": "AW User"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 0,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "9624d09a-0f3f-4e01-ab2a-6af350eef12e"
                },
                {
                  "group": "right",
                  "id": "f911f074-b519-4486-9253-80682dd7d4fc"
                },
                {
                  "group": "bottom",
                  "id": "1e03eeb1-f779-4e72-8ccb-fc63b7c86dfd"
                },
                {
                  "group": "left",
                  "id": "693ebe03-d5d3-44f4-8e49-aae66ab460f0"
                }
              ]
            },
            "id": "5da7ee5a-12f4-4e8d-8458-32d2bc736011",
            "data": {
              "type": "tm.Actor",
              "name": "AW User",
              "description": "",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "7e5381f3-083b-4655-9b4c-7aadc3228eef",
                  "title": "Access token theft",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Access token stored in browser can be impersonated by attacker and  stolen\n",
                  "mitigation": "1.  Key cloak providing Short lived tokens\n2.  Enforcing CSP on AW Gateway\n3.  Key cloak tokens are stored in Session Storage and hence cleared during Tab close.\n",
                  "modelType": "default",
                  "new": false,
                  "number": 6,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 105,
              "y": 360
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "WebRTC \nNPM Package\n"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 1,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "1a43bed7-5db5-4614-9c5a-b51f4129f994"
                },
                {
                  "group": "right",
                  "id": "d810cc36-a2ee-4334-9bf3-cdf842c86c2f"
                },
                {
                  "group": "bottom",
                  "id": "4231b301-1841-4fee-817b-a79246204409"
                },
                {
                  "group": "left",
                  "id": "a8289a3c-0b1b-4b47-994e-7750b7942e8b"
                }
              ]
            },
            "id": "4b777692-1bcc-4025-94a6-b85b52e9d978",
            "data": {
              "type": "tm.Process",
              "name": "WebRTC \nNPM Package\n",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "a98474d5-038b-4fa6-88a4-213664d50702",
                  "title": "Mailicious 3rd Party application gain access to CAXperts NPM package",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "A malicious third-party application embeds the @caxperts NPM package and uses it to appear as the legitimate viewer in Active Workspace.",
                  "mitigation": "1.  Conduct supply chain security audits of third-party libraries like @caxperts.\n2. Implementing CSP policies at AW Gateway\n3. Using OIDC client which enables PKCE and State validation",
                  "modelType": "default",
                  "new": false,
                  "number": 8,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 105,
              "y": 270
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "OIDC-client-ts \nNPM Package"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 2,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "1a43bed7-5db5-4614-9c5a-b51f4129f994"
                },
                {
                  "group": "right",
                  "id": "d810cc36-a2ee-4334-9bf3-cdf842c86c2f"
                },
                {
                  "group": "bottom",
                  "id": "4231b301-1841-4fee-817b-a79246204409"
                },
                {
                  "group": "left",
                  "id": "a8289a3c-0b1b-4b47-994e-7750b7942e8b"
                }
              ]
            },
            "id": "3205e453-bfaf-4dc7-a96e-66aa5ddff8e2",
            "data": {
              "type": "tm.Process",
              "name": "OIDC-client-ts \nNPM Package",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "bc214f9d-777e-430f-b878-846d08938bba",
                  "title": "Attacker exploits OIDC scope privillages",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Elevation of privilege",
                  "description": "An attacker exploits misconfigured or insufficient OIDC client configurations to escalate permissions (e.g., scope manipulation).",
                  "mitigation": "1. Make sure OIDC client configurations are setup from Deployment Center and stored securely.\n2. Implement principle of least privillage at the OIDC scope parameter\n---- TBD 3. CAXperts to provide Authorization policies based on Roles ----",
                  "modelType": "default",
                  "new": false,
                  "number": 10,
                  "score": ""
                },
                {
                  "id": "e0be6327-2d8c-47d1-b658-41c25aea3b85",
                  "title": "Over-privileged roles in tokens",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Access token containing more then nessesary privillage pose a bigger threat when something fails. Intruder could gain high level access to backend system and compromise the APIs",
                  "mitigation": "1. Enfore least privillage during token grant, using minimal SCOPE\n2. Issue different tokens per client\n3. Use short lived tokens",
                  "modelType": "default",
                  "new": false,
                  "number": 14,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 630,
              "y": 60
            },
            "size": {
              "width": 70,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Keycloak"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 3,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "1a43bed7-5db5-4614-9c5a-b51f4129f994"
                },
                {
                  "group": "right",
                  "id": "d810cc36-a2ee-4334-9bf3-cdf842c86c2f"
                },
                {
                  "group": "bottom",
                  "id": "4231b301-1841-4fee-817b-a79246204409"
                },
                {
                  "group": "left",
                  "id": "a8289a3c-0b1b-4b47-994e-7750b7942e8b"
                }
              ]
            },
            "id": "162d6ed3-0602-42a9-8ab8-bad940ada188",
            "data": {
              "type": "tm.Process",
              "name": "Keycloak",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "66c357ea-866b-4acd-b474-645a2b8f8685",
                  "title": "Redirect URI Misconfiguration",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Redirect URI misconfiguration (wildcards). A redirect URI can be misconfigured and attacker can spoof the redirect URL therby steal the access tokens",
                  "mitigation": "1. Only matching URLs will be redirected from Keycloak. Strict URL is enforced at Keycloak (No wildcard to be allowed)\n2. HTTPS is enforced at the Keycloak.\n3. PKCE and State validation is enforced using OIDC client at Active workspace.",
                  "modelType": "default",
                  "new": false,
                  "number": 3,
                  "score": ""
                },
                {
                  "id": "509bf607-bb4f-4760-9113-d0d6e26f9cbe",
                  "title": "DDoS Attack on Keycloak services",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "A malicious actor performs a Distributed Denial of Service (DDoS) attack against the partnerâ€™s Keycloak server or signaling server, disrupting authentication and communication.",
                  "mitigation": "1. Using DDoS protection services like (AWS Sheild or Cloudfare)\n2. Use auto-scaling feature\n3. Regularly test against simulated DDoS scenarios to assess resilience measures.",
                  "modelType": "default",
                  "new": false,
                  "number": 11,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 680,
              "y": 220
            },
            "size": {
              "width": 120,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "UDiTH"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 4,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "1a43bed7-5db5-4614-9c5a-b51f4129f994"
                },
                {
                  "group": "right",
                  "id": "d810cc36-a2ee-4334-9bf3-cdf842c86c2f"
                },
                {
                  "group": "bottom",
                  "id": "4231b301-1841-4fee-817b-a79246204409"
                },
                {
                  "group": "left",
                  "id": "a8289a3c-0b1b-4b47-994e-7750b7942e8b"
                }
              ]
            },
            "id": "773ab04a-06ec-4de1-bed4-c567d7981a52",
            "data": {
              "type": "tm.Process",
              "name": "UDiTH",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "7723d955-d3d1-407d-a7cc-4b2ff994acaa",
                  "title": "Broken backend token validation",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "CAXperts UDiTH trusting invalid tokens without validations\n",
                  "mitigation": "1. Use JWT signature verification using keycloak JWKS\n2. Reject expired token using OidcManager.removeUser() on expire event\n3. Using 'Issue Identifier' (iss) ensure token from valid keycloak realm\n4. CAXperts token aud: \"signaling\". Ensuring token is valid only for connecting to signalling service.\nEnfore least privillage in scope",
                  "modelType": "default",
                  "new": false,
                  "number": 7,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 730,
              "y": 80
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Render \nServices"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 5,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "1a43bed7-5db5-4614-9c5a-b51f4129f994"
                },
                {
                  "group": "right",
                  "id": "d810cc36-a2ee-4334-9bf3-cdf842c86c2f"
                },
                {
                  "group": "bottom",
                  "id": "4231b301-1841-4fee-817b-a79246204409"
                },
                {
                  "group": "left",
                  "id": "a8289a3c-0b1b-4b47-994e-7750b7942e8b"
                }
              ]
            },
            "id": "d16e8700-787b-4400-8972-782a18de524c",
            "data": {
              "type": "tm.Process",
              "name": "Render \nServices",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "86dbd57f-97b8-426d-bd24-b3a289a3f934",
                  "title": "DDoS attack on Render services",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker exploits a vulnerability in the @caxperts NPM package or WebRTC implementation to flood the servers with bogus connection requests.",
                  "mitigation": "1. Deploy application-layer protection using Web Application Firewalls (WAFs).\n2. Regularly patch the @caxperts NPM package and WebRTC implementations with the latest security updates.\n3. Implement anomaly detection algorithms to detect and block suspicious connection patterns.\n4. Rate-limit incoming connection requests per user/session.",
                  "modelType": "default",
                  "new": false,
                  "number": 13,
                  "score": ""
                }
              ]
            }
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "AW Gateway",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false,
              "crossingFlows": [
                "18eaf04e-cd52-435d-9e77-741a9306db38",
                "8b0c97de-510f-4d65-9961-ae9b352b2abc"
              ],
              "containedElements": [
                "3205e453-bfaf-4dc7-a96e-66aa5ddff8e2"
              ]
            },
            "labels": [
              "AW Gateway"
            ],
            "id": "3ed569ea-2620-4ca5-84d7-7f6888ab3090",
            "source": {
              "x": 15,
              "y": 244
            },
            "target": {
              "x": 510,
              "y": 450
            },
            "vertices": [
              {
                "x": 280,
                "y": 200
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "CAXperts UDiTH",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false,
              "crossingFlows": [
                "18eaf04e-cd52-435d-9e77-741a9306db38"
              ],
              "containedElements": [
                "162d6ed3-0602-42a9-8ab8-bad940ada188"
              ]
            },
            "labels": [
              "CAXperts UDiTH"
            ],
            "id": "962ede3f-9dbb-457a-801a-93c5a209c025",
            "source": {
              "x": 580,
              "y": 20
            },
            "target": {
              "x": 720,
              "y": 430
            },
            "vertices": [
              {
                "x": 530,
                "y": 170
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "open embedded viewer",
              "description": "User opens viewer tab from Active workspace Plant breakdown structure",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": true,
              "isPublicNetwork": true,
              "protocol": "https",
              "threats": [],
              "trustBoundaryIds": []
            },
            "labels": [
              "open embedded viewer"
            ],
            "id": "771d2ec8-d097-45c0-998a-2fb275cc789e",
            "source": {
              "cell": "5da7ee5a-12f4-4e8d-8458-32d2bc736011",
              "port": "1e03eeb1-f779-4e72-8ccb-fc63b7c86dfd"
            },
            "target": {
              "cell": "aa874d0b-4298-4f51-9ad7-e00043926cb3",
              "port": "1a43bed7-5db5-4614-9c5a-b51f4129f994"
            },
            "vertices": [
              {
                "x": 40,
                "y": 160
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "authorize and get access tokens",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "https",
              "threats": [
                {
                  "id": "7f8d79a8-7385-4cc8-a0dd-1f003d6d5c19",
                  "title": "Authorization code interception",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "The attack happens when an attacker manages to capture the authorization code in transit\n\ta. Man-in-the-Middle  attack\n\tb. Open redirect / wildcard redirect URIs\n        c. XSS / malicious script in SPA",
                  "mitigation": "1. Enabled PKCE using response_type=code \n2. Enable State\n3. Enfore HTTPS and valid redirect URLs only\n",
                  "modelType": "default",
                  "new": false,
                  "number": 4,
                  "score": ""
                }
              ],
              "trustBoundaryIds": [
                "3ed569ea-2620-4ca5-84d7-7f6888ab3090",
                "962ede3f-9dbb-457a-801a-93c5a209c025"
              ]
            },
            "labels": [
              "authorize and get access tokens"
            ],
            "id": "18eaf04e-cd52-435d-9e77-741a9306db38",
            "source": {
              "cell": "3205e453-bfaf-4dc7-a96e-66aa5ddff8e2",
              "port": "d810cc36-a2ee-4334-9bf3-cdf842c86c2f"
            },
            "target": {
              "cell": "162d6ed3-0602-42a9-8ab8-bad940ada188",
              "port": "a8289a3c-0b1b-4b47-994e-7750b7942e8b"
            },
            "vertices": [
              {
                "x": 320,
                "y": 330
              },
              {
                "x": 430,
                "y": 310
              },
              {
                "x": 480,
                "y": 230
              },
              {
                "x": 570,
                "y": 140
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "signin popup",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": true,
              "protocol": "https",
              "threats": [
                {
                  "id": "305a6de7-88df-4702-8782-d923ee78af31",
                  "title": "Tampering Popup Window",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Tampering Popup Window to capture OIDC request parameters such as redirect_uri, client_id or scope.",
                  "mitigation": "1. CSP entries are added at the Active workspace Gateway allowing only valid Keycloak redirections.\n2. Client uses built in signinPopup() from OIDC-client-ts package which handles PKCE, CSRF\n3. Teamcenter and Authorization server (keycloak) are served in https://",
                  "modelType": "default",
                  "new": false,
                  "number": 2,
                  "score": ""
                },
                {
                  "id": "0c0a3242-de5c-4b7b-ac24-d8bac40c06d0",
                  "title": "XSS enabling auth flow manipulation",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attacker can execute cross-side scripting to intercept authorization and steal tokens\n",
                  "mitigation": "Adding CSP rules at AW Gateway to allow only CAXperts and Keycloak connections ",
                  "modelType": "default",
                  "new": false,
                  "number": 5,
                  "score": ""
                }
              ],
              "trustBoundaryIds": [
                "3ed569ea-2620-4ca5-84d7-7f6888ab3090"
              ]
            },
            "labels": [
              "signin popup"
            ],
            "id": "8b0c97de-510f-4d65-9961-ae9b352b2abc",
            "source": {
              "cell": "3205e453-bfaf-4dc7-a96e-66aa5ddff8e2",
              "port": "1a43bed7-5db5-4614-9c5a-b51f4129f994"
            },
            "target": {
              "cell": "5da7ee5a-12f4-4e8d-8458-32d2bc736011",
              "port": "f911f074-b519-4486-9253-80682dd7d4fc"
            },
            "vertices": [
              {
                "x": 180,
                "y": 180
              },
              {
                "x": 185,
                "y": 130
              },
              {
                "x": 140,
                "y": 85
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "start model rendering",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "wss",
              "threats": [
                {
                  "id": "1b49653c-93e2-463e-adb4-36e4d150bae2",
                  "title": "Invalid registration at the STUN/TURN servers and connect to WebRTC",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker falsely registers as a legitimate STUN/TURN server during connection establishment to intercept WebRTC communication.",
                  "mitigation": "1. Enforce the use of authenticated and authorized STUN/TURN servers.\n2. Use server-side certificates to verify the identity of STUN/TURN servers.\n3. Implement a hardcoded allowlist of trusted STUN/TURN servers.\n4. Use secure signaling protocols such as DTLS.\n5.  Regularly audit and monitor signaling logs for suspicious server registrations.",
                  "modelType": "default",
                  "new": false,
                  "number": 9,
                  "score": ""
                }
              ],
              "trustBoundaryIds": []
            },
            "labels": [
              "start model rendering"
            ],
            "id": "150af874-4ee6-4fff-abfd-31ea5337fb33",
            "source": {
              "cell": "773ab04a-06ec-4de1-bed4-c567d7981a52",
              "port": "d810cc36-a2ee-4334-9bf3-cdf842c86c2f"
            },
            "target": {
              "cell": "d16e8700-787b-4400-8972-782a18de524c",
              "port": "d810cc36-a2ee-4334-9bf3-cdf842c86c2f"
            },
            "vertices": [
              {
                "x": 900,
                "y": 240
              },
              {
                "x": 900,
                "y": 170
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "connect to streaming model",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": true,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "wss",
              "threats": [
                {
                  "id": "0056ac83-cdf6-4efa-8a54-4efd71f2c84a",
                  "title": "DDoS attack on STUN/TURN servers",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker floods the TURN server with excessive stun/relay requests, exhausting its resources.",
                  "mitigation": "1. Enforce STUN/TURN rate-limiting mechanisms to throttle excessive requests.\n2. Scale horizontally by deploying additional TURN servers.'\n3. Deploy IP-based or token-based request filtering for TURN services.<b",
                  "modelType": "default",
                  "new": false,
                  "number": 12,
                  "score": ""
                }
              ],
              "trustBoundaryIds": []
            },
            "labels": [
              "connect to streaming model"
            ],
            "id": "de84224b-d269-418c-8012-06f6fa3fb28b",
            "source": {
              "cell": "4b777692-1bcc-4025-94a6-b85b52e9d978",
              "port": "d810cc36-a2ee-4334-9bf3-cdf842c86c2f"
            },
            "target": {
              "cell": "773ab04a-06ec-4de1-bed4-c567d7981a52",
              "port": "a8289a3c-0b1b-4b47-994e-7750b7942e8b"
            },
            "vertices": [
              {
                "x": 350,
                "y": 430
              },
              {
                "x": 430,
                "y": 400
              },
              {
                "x": 470,
                "y": 390
              },
              {
                "x": 620,
                "y": 300
              }
            ]
          },
          {
            "position": {
              "x": 279,
              "y": 100
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Internet"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 11,
            "id": "56f50676-0f8e-4493-ac46-56afea21fad1",
            "data": {
              "type": "tm.Text",
              "name": "Internet",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": -50,
              "y": 300
            },
            "size": {
              "width": 220,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "AW Embedded \nViewer Component"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 12,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "1a43bed7-5db5-4614-9c5a-b51f4129f994"
                },
                {
                  "group": "right",
                  "id": "d810cc36-a2ee-4334-9bf3-cdf842c86c2f"
                },
                {
                  "group": "bottom",
                  "id": "4231b301-1841-4fee-817b-a79246204409"
                },
                {
                  "group": "left",
                  "id": "a8289a3c-0b1b-4b47-994e-7750b7942e8b"
                }
              ]
            },
            "id": "aa874d0b-4298-4f51-9ad7-e00043926cb3",
            "data": {
              "type": "tm.Process",
              "name": "AW Embedded \nViewer Component",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "b33e8866-8a62-432b-a017-0ab5edbc40e5",
                  "title": "Expired token misuse ",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An access token is accepted after its expiration due to missing or incorrect validation.\n",
                  "mitigation": "1. Using OIDC client API to validate if access token is expired. If expired, removeUser and ask to signin again\n2. CAXperts providing with short lived tokens (5mins) and refresh tokens\n3. Refresh token rotation is set to 0 in keycloak, enabling to discard refresh_token after single use.\n",
                  "modelType": "default",
                  "new": false,
                  "number": 16,
                  "score": ""
                },
                {
                  "id": "9613d3fe-fe78-45fd-9812-32c0a38fc001",
                  "title": "Silent renew abuse",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Silent token renewal is abused (e.g., via hidden iframes or background refresh) to maintain access without user awareness or beyond intended session duration.",
                  "mitigation": "1. Using OIDC client to enable silentTokenRefresh\n2. Refresh token rotation is set to 0 in keycloak, enabling to discard refresh_token after single use.\n3. Enabled PKCE using OIDC client to handle token validations\n",
                  "modelType": "default",
                  "new": false,
                  "number": 17,
                  "score": ""
                }
              ]
            },
            "tools": {
              "items": [
                "boundary",
                "button-remove"
              ],
              "name": null
            }
          }
        ]
      }
    ],
    "diagramTop": 4,
    "reviewer": "",
    "threatTop": 17
  }
}